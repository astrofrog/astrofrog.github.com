
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>.py in the sky</title>
  <meta name="author" content="Thomas Robitaille">

  
  <meta name="description" content="Why we might want to do it I think it&#8217;s fair to say I&#8217;m addicted to using
GitHub. I&#8217;ve used it so much in the last couple of
years &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://astrofrog.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/rss.xml" rel="alternate" title=".py in the sky" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37635519-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">.py in the sky</a></h1>
  
    <h2>Musings on Python, Astronomy, and Open Science</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/rss.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:astrofrog.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/10/how-to-conduct-a-full-code-review-on-github/">How to Conduct a Full Code Review on GitHub</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-10T13:38:00+02:00" pubdate data-updated="true">Apr 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Why we might want to do it</h2>

<p>I think it&#8217;s fair to say I&#8217;m addicted to using
<a href="http://www.github.com">GitHub</a>. I&#8217;ve used it so much in the last couple of
years that I don&#8217;t understand/remember how we got any serious collaborative
coding done before. In particular, the ability to comment on code
line-by-line, having conversations, updating the pull requests, and merging
them with a single click is in my mind so much more rewarding and productive
than having to comment on a patch in an email discussion.</p>

<p>However, I occasionally want to do a full review of a package that someone
else has written, and comment on various parts of the code. While it is
possible to leave line-by-line comments on a commit-by-commit basis, GitHub
does not provide an official way to review the latest <em>full</em> version of a file
or package.</p>

<p>There are a few ways to conduct a full code review that I can think of:</p>

<ol>
<li><p>Browse through the files, on GitHub or locally, and open new issues
for anything we would like to comment on, copying and pasting the relevant
code. Not ideal if we want to comment on 20-30 chunks of code or more!</p></li>
<li><p>Browse through the files on GitHub, and if we see a line we want to comment
on, we can go to the <em>Blame</em> tab, and then find the last commit that
modified that line, and comment on it. The issue with this is that we might
want to comment on a chunk of code that was the result of several commits in
which case this method breaks down.</p></li>
<li><p>Leverage the <a href="https://help.github.com/articles/using-pull-requests">pull request</a>
interface, with a little git-<em>fu</em>, to conduct a proper full code review.
This is in my opinion the best approach, and in this post, I describe one
way to do this. There may be more elegant ways, so please let me know if you
have any suggestions!</p></li>
</ol>


<h2>How to do it</h2>

<p>Ideally, one could simply create an empty branch on GitHub, then set up a pull
request from <code>master</code> (or whatever branch you want to review) onto the empty
branch. However, as far as I can tell, you can&#8217;t create completely empty
branches on GitHub - instead, we need our empty branch to have at least one
commit, which needs to match the first commit of the branch we want to review
(otherwise GitHub will complain that there is no common history).</p>

<p>So how we proceed depends on whether the first commit contains code that needs
to be reviewed, or if it is unimportant (for example, a lot of repositories
start with the addition of an empty README file).</p>

<h3>If the first commit is unimportant&#8230;</h3>

<p>&#8230; then the situation is fairly easy. You first need to find out the commit
hash for the first commit in the repository, which you can do with:</p>

<pre><code>$ git rev-list --all | tail -1
ec2287e5837386c54fbd082021530aa18c0dcf18
</code></pre>

<p>In the example above the hash is <code>ec2287e5837386c54fbd082021530aa18c0dcf18</code>,
but this will be different for you. Now, create an empty branch containing
only that commit:</p>

<pre><code>$ git branch empty ec2287e5837386c54fbd082021530aa18c0dcf18
</code></pre>

<p>This will create, but not switch to, the empty branch. Next push your
<code>empty</code> branch to GitHub:</p>

<pre><code>$ git push origin empty
</code></pre>

<p>Go to your repository on GitHub and click on the &#8216;Pull Request&#8217; button at the
top right of the window:</p>

<p><img class="center" src="/images/code_review/pull_request_1.png"></p>

<p>Then set it up so that you are pulling the changes from <code>master</code> into
<code>empty</code>, as follows:</p>

<p><img class="center" src="/images/code_review/pull_request_2.png"></p>

<p>You can now enter a title and message for the pull request, and invite other
people to comment on the code. If you make changes to <code>master</code>, you can
simply push the changes to GitHub as usual:</p>

<pre><code>$ git push origin master
</code></pre>

<p>which should cause the new commits to appear in the pull request. Once the
review is complete, you can just close the pull request (without merging), and
keep the empty branch for future reviews (or delete it).</p>

<h3>If the first commit is important&#8230;</h3>

<p>&#8230; this makes things a little more complicated. The approach we&#8217;ll take here
is to create two new branches - <code>review</code>, containing the code to review, and
<code>empty</code>, containing no files - both of which contain a common and empty
first commit (which we will add). In this way, the two branches have a common
history, even though the <code>empty</code> branch has no files. We can set then set up
a pull request from <code>review</code> to <code>empty</code>.</p>

<p><strong>Important disclaimer</strong>: make sure that you make a backup of your repository,
and that there are no unsaved changes! If you follow these instructions, any
files that are not already in the repository <em>will</em> get deleted, as well as
any uncommitted changes! In fact, it might be safest to do this in a clean
clone of your repository, so that if anything goes wrong, you haven&#8217;t affected
your usual work repository.</p>

<p>With that disclaimer in mind, go to the repository you want to do a review
for, and then create an empty branch that we will call <code>review</code></p>

<pre><code>$ git checkout --orphan review
</code></pre>

<p>This branch has no history, but the files should still be there and would be
added to the branch if we were to commit. However, you don&#8217;t want to do this,
so remove all the files in the repository in the current branch by first
unstaging all the files:</p>

<pre><code>$ git rm -r --cached *
</code></pre>

<p>then removing them all:</p>

<pre><code>$ git clean -fxd
</code></pre>

<p>Note that any file that was not previously part of the repository will be
deleted for good, not just from this branch!</p>

<p>You should now have a nice and empty branch:</p>

<pre><code>$ git log
fatal: bad default revision 'HEAD'

$ git status
# On branch review
#
# Initial commit
#
nothing to commit (create/copy files and use "git add" to track)
</code></pre>

<p>You are now ready to set up the review. You should first add a dummy commit
that contains no files:</p>

<pre><code>$ git commit --allow-empty -m "Start of the review"
</code></pre>

<p>Then create a new branch called <code>empty</code> that will contain only this commit:</p>

<pre><code>$ git branch empty
</code></pre>

<p>This will create a branch with the same empty commit, but will keep on the
<code>review</code> branch. You can now merge in the changes from the branch we want to
actually review, say <code>master</code>, into <code>review</code>:</p>

<pre><code>$ git merge master
</code></pre>

<p>You will be asked to provide a merge commit message, and you can just leave
the default. Next push your <code>review</code> and <code>empty</code> branches to GitHub:</p>

<pre><code>$ git push origin review
$ git push origin empty
</code></pre>

<p>Go to your repository on GitHub and click on the &#8216;Pull Request&#8217; button at the
top right of the window:</p>

<p><img class="center" src="/images/code_review/pull_request_1.png"></p>

<p>Then set it up so that you are pulling the changes from <code>review</code> into
<code>empty</code>, as follows:</p>

<p><img class="center" src="/images/code_review/pull_request_3.png"></p>

<p>You can now enter a title and message for the pull request, and invite other
people to comment on the code. Make sure that you switch back to your
<code>master</code> (or other) branch to implement the changes, and if you then want to
update the review pull request, you can switch back to <code>review</code> and merge
the latest changes from <code>master</code>:</p>

<pre><code>$ git checkout review
$ git merge master
$ git push origin review
</code></pre>

<p>which should cause the new commits to appear in the pull request.</p>

<h2>Epilogue</h2>

<p>As you can see, if the first commit in your repository is unimportant, things
are actually pretty straightforward. I&#8217;d love to hear if anyone has a better
way to deal with the case where we want to review all commits, including the
first. Finally, if any GitHub employees are reading this - please make it
easier for people to conduct full reviews! :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/13/what-python-installations-are-scientists-using/">What Python Installations Are Scientists Using?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-13T10:10:00+01:00" pubdate data-updated="true">Jan 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Back in November 2012, I
<a href="https://twitter.com/astrofrog/status/269743084215103488">asked</a> Python
users in Science to fill out a survey to find out what <a href="http://www.python.org">Python</a>, <a href="http://www.numpy.org">Numpy</a>, and
<a href="http://www.scipy.org">Scipy</a> versions they were using, and how they maintain their installation. My motivation for this was to collect quantitative
information to inform discussions amongst developers regarding which versions
to support, because those discussions are usually based only on guessing and
personal experience. In particular, there has been some discussion in the
<a href="http://www.astropy.org">Astropy</a> project regarding whether we should drop
support for Numpy 1.4, but we had no quantitative information about whether
this would affect many users (which motivated this study).</p>

<p>In this post, I&#8217;ll give an overview of the results, as well as access to the
(anonymized) raw data. First, I should mention that given my area of research
and networks, the only community I obtained significant data are Astronomers,
so the results I present here only include these (though I also provide the
raw data for the remaining users for anyone interested).</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/01/13/what-python-installations-are-scientists-using/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About me</h1>
  <p>This is my (Thomas Robitaille, a.k.a. astrofrog) personal blog. I am a research group leader at the Max Planck Institute for Astronomy. I am a strong advocate of the Python programming language for Astronomy, and am one of the co-ordinators for the <a href="http://www.astropy.org">Astropy</a> package.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/10/how-to-conduct-a-full-code-review-on-github/">How to conduct a full code review on GitHub</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/13/what-python-installations-are-scientists-using/">What Python installations are scientists using?</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Blogs and Links</h1>
  <ul>
     <li><a href="http://www.mpia.de/~robitaille">Professional page at the MPIA</a>
     <li><a href="http://www.astropython.org">Astropython</a>
     <li><a href="http://www.astrobetter.com">AstroBetter</a>
     <li><a href="http://www.astropy.org">Astropy</a>
  <ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("astrofrog", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/astrofrog" class="twitter-follow-button" data-show-count="false">Follow @astrofrog</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Thomas Robitaille -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'pyinthesky';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
